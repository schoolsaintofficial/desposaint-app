import{d as b,t as F,r as L,o as l,c as p,b as a,f as w,a as m,w as r,u as e,a2 as _,$ as A,q as k,n as B,e as S,a1 as h,am as Y,h as E}from"./index-G40RhZjV.js";import{t as M,o as T,s as x,u as $,_ as I}from"./InputFormField.vue_vue_type_script_setup_true_lang-DcZHx8_5.js";import{L as N}from"./lock-keyhole-CPiSHnBo.js";import{M as P}from"./mail-BMY67FPC.js";const R={class:"mt-2.5 text-slate-600 dark:text-slate-500"},O={key:0,class:"font-medium text-primary mt-2"},j={key:1},z={key:0,class:"font-medium text-primary mt-2"},D={key:1,class:"font-medium text-primary mt-2"},G={key:2,class:"flex gap-2 mt-2"},H={class:"mt-6"},q={class:"mb-2.5"},K={class:"mt-5"},U=b({__name:"VerifyEmailForm",props:{countdown:{},codeSentMessageShow:{type:Boolean},counting:{type:Boolean},sendCode:{type:Function},start:{type:Function},setView:{type:Function},setCountdown:{type:Function},setCodeSentMessageShow:{type:Function},setCounting:{type:Function}},setup(C){const{sendVerifyEmailCodeLoading:u,verifyEmail:f,verifyEmailLoading:n}=F(),d=M(T({otp:x().regex(/^\d+$/,{message:"OTP must contain only numbers."})})),g=$({validationSchema:d}).handleSubmit(async(s,t)=>{await f(s,t)});return(s,t)=>{const o=L("vue-countdown");return l(),p("div",null,[t[7]||(t[7]=a("div",{class:"text-2xl font-medium"},"Verify Your Email",-1)),a("div",R,[t[5]||(t[5]=w(" Please check your email inbox or spam folder for the OTP verification code. ")),m(_,{name:"fade-top",mode:"out-in"},{default:r(()=>[e(u)?(l(),p("div",O," Sending OTP code... ")):(l(),p("div",j,[m(_,{name:"fade",mode:"out-in"},{default:r(()=>[s.codeSentMessageShow?(l(),p("div",z," Code has been sent âœ… ")):!s.codeSentMessageShow&&s.counting&&s.countdown>0?(l(),p("div",D,[m(o,{time:s.countdown,onEnd:t[0]||(t[0]=i=>s.setCounting(!1))},{default:r(({totalSeconds:i})=>[w("You can resend OTP in "+A(i)+" seconds.",1)]),_:1},8,["time"])])):!s.codeSentMessageShow&&!s.counting?(l(),p("div",G,[a("a",{href:"javascript:;",class:"font-medium text-primary transition-colors hover:text-slate-600 dark:hover:text-slate-400",onClick:t[1]||(t[1]=i=>!e(n)&&s.sendCode())}," Resend Code "),t[4]||(t[4]=w(" | ")),a("a",{href:"javascript:;",onClick:t[2]||(t[2]=i=>!e(n)&&s.setView("CHANGE_EMAIL")),class:"font-medium text-primary transition-colors hover:text-slate-600 dark:hover:text-slate-400"}," Change Email ")])):k("",!0)]),_:1})]))]),_:1})]),a("div",H,[a("form",{onSubmit:t[3]||(t[3]=(...i)=>e(g)&&e(g)(...i))},[a("div",q,[m(I,{name:"otp",type:"text",placeholder:"Enter OTP",disabled:e(u)||e(n)},{default:r(()=>[m(e(N),{class:"size-4"})]),_:1},8,["disabled"])]),a("div",K,[m(e(S),{type:"submit",class:B(["w-full mb-2",{"opacity-50":e(u)}]),disabled:e(u),loading:e(n),"show-loading":""},{default:r(()=>t[6]||(t[6]=[w(" Confirm ")])),_:1},8,["class","disabled","loading"])])],32)])])}}}),J={class:"mt-6"},Q={class:"mb-2.5"},W={class:"mt-5"},X=["href"],Z=b({__name:"ChangeEmailForm",props:{countdown:{},start:{type:Function},setView:{type:Function},setCountdown:{type:Function},setCodeSentMessageShow:{type:Function},setCounting:{type:Function}},setup(C){const{user:u,changeEmail:f,changeEmailLoading:n}=F(),d=C,c=M(T({email:x().email()})),s=$({validationSchema:c}).handleSubmit(async t=>{const o=await f(t);o&&(d.setView("VERIFY_EMAIL"),d.setCodeSentMessageShow(!0),d.start(),d.setCountdown(o.refreshTime-new Date().getTime()),d.countdown>0&&d.setCounting(!0))});return(t,o)=>{var i;return l(),p("div",null,[o[4]||(o[4]=a("div",{class:"text-2xl font-medium"},"Change Email",-1)),a("div",J,[a("form",{onSubmit:o[1]||(o[1]=(...y)=>e(s)&&e(s)(...y))},[a("div",Q,[m(I,{name:"email",type:"text",value:(i=e(u))==null?void 0:i.email,placeholder:"Email",disabled:e(n)},{default:r(()=>[m(e(P),{class:"size-4"})]),_:1},8,["value","disabled"])]),a("div",W,[m(e(S),{type:"submit",class:"w-full mb-2",loading:e(n),"show-loading":""},{default:r(()=>o[2]||(o[2]=[w(" Confirm ")])),_:1},8,["loading"])]),a("a",{href:e(n)?void 0:"javascript:;",onClick:o[0]||(o[0]=y=>!e(n)&&t.setView("VERIFY_EMAIL"))},[m(e(S),{type:"submit",class:"w-full disabled:opacity-50",variant:"outline",disabled:e(n)},{default:r(()=>o[3]||(o[3]=[w(" Back To Verify Email ")])),_:1},8,["disabled"])],8,X)],32)])])}}}),ne=b({__name:"VerifyEmailView",setup(C){const{sendVerifyEmailCode:u}=F(),[f,n]=h(0),[d,c]=h(!1),[g,s]=h(!0),[t,o]=h("VERIFY_EMAIL"),{start:i}=Y(()=>{c(!1)},3e3),y=async(V=!0)=>{const v=await u({updateRefreshTime:V});v&&v.wasUpdated?(c(!0),i(),n(v.refreshTime-new Date().getTime()),f.value>0&&s(!0)):(c(!1),s(!1))};return y(!1),(V,v)=>(l(),E(_,{name:e(t)==="VERIFY_EMAIL"?"fade-left":"fade-right",mode:"out-in"},{default:r(()=>[e(t)==="VERIFY_EMAIL"?(l(),E(U,{key:0,"code-sent-message-show":e(d),countdown:e(f),counting:e(g),"set-code-sent-message-show":e(c),"set-countdown":e(n),"set-counting":e(s),"set-view":e(o),start:e(i),"send-code":y},null,8,["code-sent-message-show","countdown","counting","set-code-sent-message-show","set-countdown","set-counting","set-view","start"])):e(t)==="CHANGE_EMAIL"?(l(),E(Z,{key:1,countdown:e(f),"set-code-sent-message-show":e(c),"set-countdown":e(n),"set-counting":e(s),"set-view":e(o),start:e(i)},null,8,["countdown","set-code-sent-message-show","set-countdown","set-counting","set-view","start"])):k("",!0)]),_:1},8,["name"]))}});export{ne as default};
